{"version":3,"sources":["turbopack:///[project]/node_modules/clsx/dist/clsx.mjs","turbopack:///[project]/apps/web/src/components/ui/spotlight-card.tsx","turbopack:///[project]/apps/web/src/components/news/newsroom-feed.tsx","turbopack:///[project]/apps/web/src/lib/api.ts"],"sourcesContent":["function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f)}else for(f in e)e[f]&&(n&&(n+=\" \"),n+=f);return n}export function clsx(){for(var e,t,f=0,n=\"\",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;","\"use client\";\r\n\r\nimport { useRef, useState, type HTMLAttributes } from \"react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface SpotlightCardProps extends HTMLAttributes<HTMLDivElement> {\r\n    children: React.ReactNode;\r\n    /** The stain color of the spotlight. Defaults to white/20 */\r\n    spotlightColor?: string;\r\n    /** Radius of the spotlight in pixels. Defaults to 350 */\r\n    spotlightRadius?: number;\r\n}\r\n\r\nexport function SpotlightCard({\r\n    children,\r\n    className,\r\n    spotlightColor = \"rgba(255, 255, 255, 0.15)\",\r\n    spotlightRadius = 350,\r\n    ...props\r\n}: SpotlightCardProps) {\r\n    const divRef = useRef<HTMLDivElement>(null);\r\n    const [position, setPosition] = useState({ x: 0, y: 0 });\r\n    const [opacity, setOpacity] = useState(0);\r\n\r\n    const handleMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {\r\n        if (!divRef.current) return;\r\n\r\n        const rect = divRef.current.getBoundingClientRect();\r\n        setPosition({ x: e.clientX - rect.left, y: e.clientY - rect.top });\r\n    };\r\n\r\n    const handleFocus = () => {\r\n        setOpacity(1);\r\n    };\r\n\r\n    const handleBlur = () => {\r\n        setOpacity(0);\r\n    };\r\n\r\n    const handleMouseEnter = () => {\r\n        setOpacity(1);\r\n    };\r\n\r\n    const handleMouseLeave = () => {\r\n        setOpacity(0);\r\n    };\r\n\r\n    return (\r\n        <div\r\n            ref={divRef}\r\n            onMouseMove={handleMouseMove}\r\n            onFocus={handleFocus}\r\n            onBlur={handleBlur}\r\n            onMouseEnter={handleMouseEnter}\r\n            onMouseLeave={handleMouseLeave}\r\n            className={cn(\r\n                \"relative overflow-hidden rounded-xl border border-white/10 bg-[var(--color-surface)]/50\",\r\n                className,\r\n            )}\r\n            {...props}\r\n        >\r\n            <div\r\n                className=\"pointer-events-none absolute -inset-px opacity-0 transition duration-300\"\r\n                style={{\r\n                    opacity,\r\n                    background: `radial-gradient(${spotlightRadius}px circle at ${position.x}px ${position.y}px, ${spotlightColor}, transparent 40%)`,\r\n                }}\r\n                aria-hidden=\"true\"\r\n            />\r\n            {children}\r\n        </div>\r\n    );\r\n}\r\n","\"use client\";\n\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport Link from \"next/link\";\nimport type { NewsPayload } from \"@ai-helper/types\";\nimport { motion } from \"framer-motion\";\n\nimport { fetchNewsPayload } from \"@/lib/api\";\nimport { designTokens } from \"@/lib/design/tokens\";\nimport { formatFullDate, formatNumber, formatSignedNumber } from \"@/lib/format\";\nimport { SpotlightCard } from \"@/components/ui/spotlight-card\";\n\ntype NewsroomFeedProps = {\n  initial: NewsPayload;\n  refreshIntervalMs?: number;\n};\n\nconst DEFAULT_REFRESH_INTERVAL = 2 * 60 * 1000; // 2 minutes\n\nconst articleListVariants = {\n  hidden: { opacity: 0, y: 16 },\n  visible: {\n    opacity: 1,\n    y: 0,\n    transition: {\n      when: \"beforeChildren\",\n      staggerChildren: 0.08,\n      delayChildren: 0.1,\n    },\n  },\n};\n\nconst articleItemVariants = {\n  hidden: { opacity: 0, y: 20 },\n  visible: {\n    opacity: 1,\n    y: 0,\n    transition: {\n      duration: 0.45,\n      ease: [0.22, 1, 0.36, 1],\n    },\n  },\n};\n\nexport function NewsroomFeed({ initial, refreshIntervalMs = DEFAULT_REFRESH_INTERVAL }: NewsroomFeedProps) {\n  const [payload, setPayload] = useState(initial);\n  const [lastUpdated, setLastUpdated] = useState<Date>(() => new Date(initial.articles[0]?.publishedAt ?? Date.now()));\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const sourceLookup = useMemo(\n    () => new Map(payload.sources.map((source) => [source.id, source])),\n    [payload.sources],\n  );\n\n  const getGradient = useCallback((sourceId: string | undefined) => {\n    const source = sourceId ? sourceLookup.get(sourceId) : undefined;\n    const gradient = source?.gradient ?? designTokens.gradients.digest;\n    return `linear-gradient(140deg, ${gradient.join(\", \")})`;\n  }, [sourceLookup]);\n\n  const refresh = useCallback(\n    async (showSpinner = true) => {\n      if (showSpinner) {\n        setIsRefreshing(true);\n      }\n      try {\n        const nextPayload = await fetchNewsPayload(30);\n        const hasChanged =\n          nextPayload.articles.length !== payload.articles.length ||\n          nextPayload.articles.some((article, index) => article.id !== payload.articles[index]?.id);\n\n        if (hasChanged) {\n          setPayload(nextPayload);\n          const publishedAt = nextPayload.articles[0]?.publishedAt;\n          setLastUpdated(new Date(publishedAt ?? Date.now()));\n        }\n        setError(null);\n      } catch (err) {\n        if (process.env.NODE_ENV !== \"production\") {\n          console.warn(\"[NewsroomFeed] refresh failed\", err);\n        }\n        setError(err instanceof Error ? err.message : \"Unable to refresh feed\");\n      } finally {\n        if (showSpinner) {\n          setIsRefreshing(false);\n        }\n      }\n    },\n    [payload.articles],\n  );\n\n  useEffect(() => {\n    if (refreshIntervalMs <= 0) return;\n    const id = setInterval(() => {\n      void refresh(false);\n    }, refreshIntervalMs);\n    return () => clearInterval(id);\n  }, [refresh, refreshIntervalMs]);\n\n  const { digest, articles, sources } = payload;\n\n  return (\n    <section className=\"flex flex-col gap-16\">\n      <header className=\"flex flex-col gap-6\">\n        <div className=\"flex flex-wrap items-center gap-3\">\n          <motion.span\n            initial={{ opacity: 0, y: 4 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"inline-flex items-center gap-2 rounded-full border border-[var(--border-soft)]/60 bg-[var(--color-surface)]/40 px-4 py-1 text-[10px] font-semibold uppercase tracking-[0.42em] text-[var(--color-muted)]/85\"\n          >\n            <span className=\"inline-flex h-2 w-2 animate-pulse rounded-full bg-[var(--accent-secondary)]\" aria-hidden />\n            Live Signal Deck\n          </motion.span>\n          <span className=\"text-xs uppercase tracking-[0.32em] text-[var(--color-muted)]/70\">\n            Updated {formatFullDate(lastUpdated)}\n          </span>\n        </div>\n        <div className=\"flex flex-col gap-3\">\n          <h1 className=\"text-4xl font-semibold text-[var(--color-foreground)] sm:text-[42px]\">\n            AI Newsroom Briefings\n          </h1>\n          <p className=\"max-w-3xl text-base leading-relaxed text-[var(--color-muted)] sm:text-lg\">\n            Trusted coverage from official AI labs and ecosystem partners. We ingest verified RSS feeds, score launches,\n            and package rapid-fire summaries so you can stay in the product without doomscrolling.\n          </p>\n        </div>\n        <div className=\"flex flex-wrap items-center gap-3\">\n          <button\n            type=\"button\"\n            onClick={() => refresh()}\n            className=\"inline-flex items-center gap-2 rounded-full border border-[var(--border-soft)]/70 bg-[var(--color-surface)]/60 px-4 py-2 text-[11px] font-semibold uppercase tracking-[0.32em] text-[var(--color-muted)]/80 transition hover:text-[var(--color-foreground)]\"\n            disabled={isRefreshing}\n          >\n            <span\n              className={`h-2 w-2 rounded-full ${isRefreshing ? \"bg-[var(--accent-secondary)] animate-ping\" : \"bg-[var(--accent-secondary)]\"}`}\n            />\n            Refresh\n          </button>\n          {error ? (\n            <span className=\"text-xs text-[var(--accent-quaternary)]\">\n              {error}\n            </span>\n          ) : null}\n        </div>\n      </header>\n\n      {digest ? (\n        <div className=\"grid gap-8 lg:grid-cols-[1.35fr_1fr] 2xl:grid-cols-[1.5fr_1fr]\">\n          <article className=\"relative overflow-hidden rounded-[var(--radius-xxl)] border border-[var(--border-soft)]/60 bg-[var(--color-surface)]/50 px-12 py-10 shadow-[var(--shadow-soft)]\">\n            <div\n              aria-hidden\n              className=\"absolute inset-0 opacity-80\"\n              style={{ background: `linear-gradient(140deg, ${designTokens.gradients.digest.join(\", \")})` }}\n            />\n            <div aria-hidden className=\"pointer-events-none absolute inset-0 overflow-hidden\">\n              <div className=\"mesh-flow absolute -inset-10 rounded-full\" />\n            </div>\n            <div className=\"relative flex h-full flex-col gap-6 text-white\">\n              <div className=\"flex items-center justify-between text-[11px] uppercase tracking-[0.4em] text-white/70\">\n                <span>Weekly Digest</span>\n                <span>{digest.articleIds.length} STORIES</span>\n              </div>\n              <div className=\"space-y-3\">\n                <h2 className=\"text-3xl font-semibold leading-tight\">{digest.headline}</h2>\n                <p className=\"text-base text-white/80\">{digest.summary}</p>\n              </div>\n              <div className=\"mt-auto flex flex-wrap gap-3 text-[11px] text-white/80\">\n                {digest.articleIds.map((articleId) => {\n                  const article = articles.find((item) => item.id === articleId);\n                  if (!article) return null;\n                  const source = sourceLookup.get(article.sourceId);\n                  return (\n                    <span key={articleId} className=\"rounded-full border border-white/25 bg-white/10 px-3 py-1\">\n                      {source?.name ?? \"Unknown\"}\n                    </span>\n                  );\n                })}\n              </div>\n              <div className=\"flex items-center gap-3 text-[11px] uppercase tracking-[0.32em] text-white/65\">\n                <span className=\"inline-flex h-2 w-2 rounded-full bg-white/80\" aria-hidden />\n                Auto-built every Sunday 18:00 UTC\n              </div>\n            </div>\n          </article>\n\n          <aside className=\"flex h-full flex-col gap-6 rounded-[var(--radius-xxl)] border border-[var(--border-soft)]/60 bg-[var(--color-surface)]/40 px-10 py-8 shadow-[var(--shadow-soft)]\">\n            <div className=\"space-y-3\">\n              <span className=\"text-xs uppercase tracking-[0.38em] text-[var(--color-muted)]/75\">\n                Ingestion Approach\n              </span>\n              <h3 className=\"text-xl font-semibold text-[var(--color-foreground)]\">Cron-staged, QA-reviewed</h3>\n              <p className=\"text-sm leading-relaxed text-[var(--color-muted)]\">\n                Thirty-minute RSS pulls, structured summaries, and delta scoring for GitHub repos keep this feed aligned\n                with primary sources. Prometheus-backed metrics and alerting ensure reliability.\n              </p>\n            </div>\n            <div className=\"rounded-[var(--radius-xl)] border border-[var(--border-soft)]/50 bg-[var(--color-surface-elevated)]/40 p-6 text-sm text-[var(--color-muted)]\">\n              <p className=\"font-semibold uppercase tracking-[0.32em] text-[var(--color-muted)]/80\">Source Mix</p>\n              <ul className=\"mt-4 space-y-2\">\n                {sources.slice(0, 4).map((source) => (\n                  <li key={source.id} className=\"flex items-center justify-between\">\n                    <span>{source.name}</span>\n                    <span className=\"text-[var(--color-muted)]/70\">Weight {source.weight.toFixed(2)}</span>\n                  </li>\n                ))}\n              </ul>\n            </div>\n          </aside>\n        </div>\n      ) : null}\n\n      <motion.div\n        className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4\"\n        variants={articleListVariants}\n        initial=\"hidden\"\n        animate=\"visible\"\n      >\n        {articles.map((article) => {\n          const source = sourceLookup.get(article.sourceId);\n          return (\n            <motion.div key={article.id} variants={articleItemVariants}>\n              <SpotlightCard\n                className=\"group flex h-full flex-col gap-6 p-6 transition-transform duration-300 hover:-translate-y-1\"\n                tabIndex={0}\n                data-hotkey-target=\"news-card\"\n              >\n                <div\n                  aria-hidden\n                  className=\"pointer-events-none absolute inset-0 opacity-0 transition-opacity duration-300 group-hover:opacity-10\"\n                  style={{ background: getGradient(article.sourceId) }}\n                />\n                <div className=\"relative flex h-full flex-col gap-5\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-[10px] font-bold uppercase tracking-widest text-[var(--color-muted)]/60\">\n                      {source?.name ?? \"Unknown\"}\n                    </span>\n                    <span className=\"text-[10px] uppercase tracking-widest text-[var(--color-muted)]/40\">\n                      {formatFullDate(new Date(article.publishedAt))}\n                    </span>\n                  </div>\n\n                  <div className=\"space-y-3\">\n                    <h3 className=\"font-display text-2xl leading-none font-semibold text-[var(--color-foreground)] group-hover:text-[var(--color-accent-primary)] transition-colors\">\n                      {article.title}\n                    </h3>\n                    <p className=\"line-clamp-3 text-sm leading-relaxed text-[var(--color-muted)]\">\n                      {article.summary}\n                    </p>\n                  </div>\n\n                  <div className=\"mt-auto flex flex-col gap-4 pt-2\">\n                    <div className=\"flex flex-wrap items-center gap-2\">\n                      {article.tags.map((tag) => (\n                        <span key={tag} className=\"rounded-full border border-white/5 bg-white/5 px-2.5 py-0.5 text-[10px] font-medium uppercase tracking-wider text-[var(--color-muted)]\">\n                          {tag}\n                        </span>\n                      ))}\n                    </div>\n\n                    <div className=\"flex items-center justify-between border-t border-white/5 pt-4\">\n                      {article.githubRepo ? (\n                        <span className=\"flex items-center gap-2 text-xs text-[var(--color-muted)]\">\n                          <span className=\"font-mono text-[var(--color-foreground)]\">{formatNumber(article.githubRepo.stars)}</span>\n                          <span className={`${article.githubRepo.deltaStars > 0 ? 'text-[var(--accent-green)]' : 'text-[var(--color-muted)]'}`}>\n                            {formatSignedNumber(article.githubRepo.deltaStars)}\n                          </span>\n                        </span>\n                      ) : (\n                        <span className=\"text-xs text-[var(--color-muted)]/50\">Official</span>\n                      )}\n\n                      <Link\n                        href={`/news/${article.slug}`}\n                        className=\"group/link flex items-center gap-1 text-xs font-bold uppercase tracking-wider text-[var(--color-foreground)]\"\n                      >\n                        Read\n                        <span className=\"transition-transform group-hover/link:translate-x-1\">â†’</span>\n                      </Link>\n                    </div>\n                  </div>\n                </div>\n              </SpotlightCard>\n            </motion.div>\n          );\n        })}\n      </motion.div>\n    </section>\n  );\n}\n\n","import {\n  comparisonConfigSchema,\n  learnTrackSchema,\n  modelDirectoryEntrySchema,\n  modelProfileSchema,\n  newsArticleDetailSchema,\n  newsPayloadSchema,\n} from \"@ai-helper/types\";\nimport type {\n  ComparisonConfig,\n  LearnTrack,\n  ModelDirectoryEntry,\n  ModelProfile,\n  NewsArticleDetail,\n  NewsPayload,\n} from \"@ai-helper/types\";\n\nimport { comparisonConfig as fallbackComparisonConfig, modelProfiles as fallbackModelProfiles } from \"@/data/comparison-config\";\nimport { learnTracks as fallbackLearnTracks } from \"@/data/learn-tracks\";\nimport { modelDirectory as fallbackModelDirectory } from \"@/data/models\";\nimport { newsSources, placeholderNews, weeklyDigest } from \"@/data/news\";\n\nfunction resolveApiBaseUrl() {\n  if (typeof window !== \"undefined\") {\n    const clientUrl = process.env.NEXT_PUBLIC_API_URL;\n    if (!clientUrl) {\n      throw new Error(\n        \"NEXT_PUBLIC_API_URL must be set to call the AI Helper API from the browser.\",\n      );\n    }\n    return clientUrl;\n  }\n\n  const serverUrl =\n    process.env.AI_HELPER_API_URL ??\n    process.env.NEXT_PUBLIC_API_URL ??\n    process.env.API_BASE_URL;\n\n  if (!serverUrl) {\n    throw new Error(\n      \"API base URL is not configured. Set AI_HELPER_API_URL (or NEXT_PUBLIC_API_URL) before invoking the data layer.\",\n    );\n  }\n\n  return serverUrl;\n}\n\nfunction buildStaticNewsPayload(): NewsPayload {\n  const digest = weeklyDigest ? weeklyDigest : null;\n  const articles = placeholderNews.map((article) => ({\n    ...article,\n    githubRepo: article.githubRepo ?? undefined,\n    heroImage: article.heroImage ?? undefined,\n  }));\n\n  return newsPayloadSchema.parse({\n    sources: newsSources,\n    articles,\n    digest,\n  });\n}\n\nfunction buildStaticComparisonConfig(): ComparisonConfig {\n  return comparisonConfigSchema.parse(fallbackComparisonConfig);\n}\n\nfunction buildStaticModelProfiles(): ModelProfile[] {\n  return fallbackModelProfiles.map((profile) => modelProfileSchema.parse(profile));\n}\n\nfunction buildStaticLearnTracks(): LearnTrack[] {\n  return fallbackLearnTracks.map((track) => learnTrackSchema.parse(track));\n}\n\nfunction buildStaticModelDirectory(): ModelDirectoryEntry[] {\n  return fallbackModelDirectory.map((entry) => modelDirectoryEntrySchema.parse(entry));\n}\n\ntype PricingAccumulator = {\n  currency: string;\n  input?: number;\n  output?: number;\n  flatRate?: number;\n};\n\nasync function requestJson(path: string, revalidateSeconds: number | undefined): Promise<unknown> {\n  const baseUrl = resolveApiBaseUrl();\n  const endpoint = `${baseUrl}${path}`;\n  const options: RequestInit & { next?: { revalidate?: number } } = {};\n  if (revalidateSeconds !== undefined) {\n    options.next = { revalidate: revalidateSeconds };\n  } else {\n    options.cache = \"no-store\";\n  }\n  const response = await fetch(endpoint, options);\n  if (!response.ok) {\r\n    throw new Error(`Request to ${endpoint} failed with status ${response.status}`);\r\n  }\n  return response.json();\n}\n\nasync function fetchLiveNewsFallback(): Promise<NewsPayload | null> {\n  try {\n    if (typeof window === \"undefined\") {\n      const liveNewsModule = await import(\"./live-news\");\n      return await liveNewsModule.buildLiveNewsPayload();\n    }\n\n    const response = await fetch(\"/api/news/live\", {\n      cache: \"no-store\",\n    });\n    if (!response.ok) {\n      return null;\n    }\n    const data = await response.json();\n    return newsPayloadSchema.parse(data);\n  } catch (error) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.warn(\n        `[fetchLiveNewsFallback] Unable to load live news: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n      );\n    }\n    return null;\n  }\n}\n\nexport async function fetchNewsPayload(revalidateSeconds = 60): Promise<NewsPayload> {\n  try {\n    const data = await requestJson(\"/news\", revalidateSeconds);\n    return newsPayloadSchema.parse(data);\n  } catch (error) {\n    const livePayload = await fetchLiveNewsFallback();\n    if (livePayload) {\n      return livePayload;\n    }\n\n    if (process.env.NODE_ENV !== \"production\") {\n      console.warn(\n        `[fetchNewsPayload] Falling back to static dataset: ${\n          error instanceof Error ? error.message : \"Unknown error\"\n        }`,\n      );\n    }\n    return buildStaticNewsPayload();\n  }\n}\n\nexport async function fetchNewsArticleDetail(\n  slug: string,\n  revalidateSeconds = 60,\n): Promise<NewsArticleDetail> {\n  try {\n    const data = await requestJson(`/news/${slug}`, revalidateSeconds);\n    return newsArticleDetailSchema.parse(data);\n  } catch (error) {\n    const livePayload = await fetchLiveNewsFallback();\n    if (livePayload) {\n      const article = livePayload.articles.find((item) => item.slug === slug);\n      if (article) {\n        const source = livePayload.sources.find((item) => item.id === article.sourceId) ?? null;\n        const related = livePayload.articles.filter((item) => item.slug !== slug).slice(0, 6);\n        return newsArticleDetailSchema.parse({\n          article,\n          source,\n          related,\n        });\n      }\n    }\n\n    if (process.env.NODE_ENV !== \"production\") {\n      console.warn(\n        `[fetchNewsArticleDetail] Falling back to static dataset: ${\n          error instanceof Error ? error.message : \"Unknown error\"\n        }`,\n      );\r\n    }\r\n    const fallback = buildStaticNewsPayload();\r\n    const article = fallback.articles.find((item) => item.slug === slug);\r\n    if (!article) {\r\n      throw error instanceof Error ? error : new Error(\"Article not found\");\r\n    }\r\n    const source = fallback.sources.find((item) => item.id === article.sourceId) ?? null;\r\n    const related = fallback.articles.filter((item) => item.slug !== slug).slice(0, 6);\n    return newsArticleDetailSchema.parse({\n      article,\n      source,\n      related,\n    });\n  }\n}\n\nexport async function fetchComparisonConfig(revalidateSeconds = 3600): Promise<ComparisonConfig> {\n  try {\n    const data = await requestJson(\"/comparisons/config\", revalidateSeconds);\n    return comparisonConfigSchema.parse(data);\n  } catch (error) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.warn(\n        `[fetchComparisonConfig] Falling back to static dataset: ${\n          error instanceof Error ? error.message : \"Unknown error\"\n        }`,\n      );\n    }\n    return buildStaticComparisonConfig();\n  }\n}\n\nexport async function fetchComparisonModels(revalidateSeconds = 3600): Promise<ModelProfile[]> {\n  try {\n    const data = await requestJson(\"/comparisons/models\", revalidateSeconds);\n    return Array.isArray(data) ? data.map((item) => modelProfileSchema.parse(item)) : buildStaticModelProfiles();\n  } catch (error) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.warn(\n        `[fetchComparisonModels] Falling back to static dataset: ${\n          error instanceof Error ? error.message : \"Unknown error\"\n        }`,\n      );\n    }\n    return buildStaticModelProfiles();\n  }\n}\n\nexport async function fetchLearnTracks(revalidateSeconds = 3600): Promise<LearnTrack[]> {\n  try {\n    const data = await requestJson(\"/learn/tracks\", revalidateSeconds);\n    return Array.isArray(data) ? data.map((item) => learnTrackSchema.parse(item)) : buildStaticLearnTracks();\n  } catch (error) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.warn(\n        `[fetchLearnTracks] Falling back to static dataset: ${\n          error instanceof Error ? error.message : \"Unknown error\"\n        }`,\n      );\n    }\n    return buildStaticLearnTracks();\n  }\n}\n\nexport async function fetchModelDirectory(revalidateSeconds = 3600): Promise<ModelDirectoryEntry[]> {\n  try {\n    const data = await requestJson(\"/comparisons/models\", revalidateSeconds);\n    if (!Array.isArray(data)) {\n      return buildStaticModelDirectory();\n    }\n    return data.map((item) => {\n      const pricing = item.pricing.reduce(\n        (acc: PricingAccumulator, tier: { tier: string; pricePerMillion: number; currency?: string }) => {\n          const currency = tier.currency ?? acc.currency;\n          acc.currency = currency;\n          if (tier.tier === \"input\") acc.input = tier.pricePerMillion;\n          if (tier.tier === \"output\") acc.output = tier.pricePerMillion;\n          if (tier.tier === \"requests\") acc.flatRate = tier.pricePerMillion;\n          return acc;\n        },\n        { currency: \"USD\" } as PricingAccumulator,\n      );\n\n      return modelDirectoryEntrySchema.parse({\n        id: item.id,\n        name: item.name,\n        provider: item.provider,\n        releaseDate: item.releaseDate,\n        contextWindow: item.contextWindow,\n        pricing,\n        licensing:\n          item.license === \"open-source\"\n            ? \"open-source\"\n            : item.license === \"proprietary\"\n            ? \"proprietary\"\n            : \"mixed\",\n        deployment: item.availability,\n        website: item.website ?? item.sources[0] ?? \"https://example.com\",\n        tags: item.context.modalities,\n        sourceUrls: item.sources,\n      });\n    });\n  } catch (error) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.warn(\n        `[fetchModelDirectory] Falling back to static dataset: ${\n          error instanceof Error ? error.message : \"Unknown error\"\n        }`,\n      );\n    }\n    return buildStaticModelDirectory();\n  }\n}\n\r\n"],"names":[],"mappings":"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","ignoreList":[0]}